const XLSX = require('xlsx');
const fs = require('fs');

const data = [
  [
    "PGID", "PG名称", "納品(1)", "工数(1)", "開始日(1)", "終了日(1)", "担当1", "開始日1", "終了日1", "進捗率1", "工数1", "PageTK1", "コメント",
    "工数(2)", "開始日(2)", "終了日(2)", "担当2", "開始日2", "終了日2", "進捗率2", "工数2", "不具合2", "コメント2",
    "納品(3)", "工数(3)", "開始日(3)", "終了日(3)", "担当3", "開始日3", "終了日3", "進捗率3", "工数3", "テスト3", "不具合3", "PageTK3", "コメント3",
    "工数(4)", "開始日(4)", "終了日(4)", "担当4", "開始日4", "終了日4", "進捗率4", "工数4", "テスト4", "不具合4", "コメント4"
  ],
  [
    "FJS12345", "神奈川プロジェクト", "2025-06-01", 100, "2025-05-01", "2025-05-31", "山田太郎", "2025-05-02", "2025-05-30", 95, 90, 10, "設計完了",
    50, "2025-06-01", "2025-06-15", "佐藤花子", "2025-06-02", "2025-06-14", 90, 45, 2, "レビュー済み",
    "2025-07-01", 200, "2025-06-16", "2025-07-15", "鈴木一郎", "2025-06-17", "2025-07-14", 80, 180, 50, 3, 15, "コーディング進行中",
    80, "2025-07-16", "2025-08-15", "田中次郎", "2025-07-17", "2025-08-10", 70, 60, 100, 5, "テスト中"
  ],
  [
    "FJS67890", "東京プロジェクト", "2025-08-01", 120, "2025-07-01", "2025-07-31", "高橋美咲", "2025-07-03", "2025-07-30", 85, 110, 12, "設計一部遅延",
    60, "2025-08-01", "2025-08-20", "中村健", "2025-08-02", "2025-08-18", 75, 55, 1, "レビュー中",
    "2025-09-01", 250, "2025-08-21", "2025-09-30", "小林優", "2025-08-22", "2025-09-25", 60, 200, 60, 4, 20, "コーディング遅延",
    100, "2025-10-01", "2025-10-31", "松本玲", "2025-10-02", "", 50, 80, 120, 6, "テスト開始"
  ],
  [
    "FJS11223", "大阪プロジェクト", "2025-10-01", 80, "2025-09-01", "2025-09-30", "藤田翔", "", "", 10, 0, 8, "設計未開始",
    40, "2025-10-01", "2025-10-15", "岡本真", "", "", 0, 0, 0, "レビュー未開始",
    "2025-11-01", 150, "2025-10-16", "2025-11-15", "石川涼", "", "", 0, 0, 0, 0, 0, "コーディング未開始",
    70, "2025-11-16", "2025-12-15", "森田彩", "", "", 0, 0, 0, 0, "テスト未開始"
  ]
];

// Create a new workbook and worksheet
const workbook = XLSX.utils.book_new();
const worksheet = XLSX.utils.aoa_to_sheet(data);

// Add the table to the worksheet
worksheet['!ref'] = XLSX.utils.encode_range({ s: { r: 0, c: 0 }, e: { r: data.length - 1, c: data[0].length - 1 } });
workbook.Workbook = { Tables: [{ Name: 'schedule', Ref: `Sheet1!A1:AR${data.length}` }] };

// Append the worksheet to the workbook
XLSX.utils.book_append_sheet(workbook, worksheet, 'Sheet1');

// Write the file
XLSX.writeFile(workbook, '/Users/tannguyen/test_schedule.xlsx');
console.log('Excel file created at /Users/tannguyen/test_schedule.xlsx');